{"id":2,"name":"FakeNT","useGroups":false,"runOnActivate":true,"group":"","importUrl":"https://raw.githubusercontent.com/TW-IDLE/scripts/master/FakeNT.json","params":{"origin":"","target":"","troop":"spear","quantity":"5"},"nextStepId":2,"steps":[{"id":1,"gotoUrl":"{gameUrl}?village={origin}&screen=place&target={target}\n","script":"function delay(time, random = 0) {\n  return new Promise(function (resolve) {\n    setTimeout(resolve, time + parseInt(Math.random() * random));\n  });\n}\n\nnew Promise(async (resolve, reject) => {\n  try {\n    function createIframe(id, url) {\n      return (\n        '<iFRAME SRC=\"' +\n        url +\n        '\" name=\"' +\n        id +\n        '\" width=\"840\" height=\"500\"></iframe>'\n      );\n    }\n\n    function setTroop(name, troop, quantity) {\n      return `window.frames[\"${name}\"].document.getElementById(\"unit_input_${troop}\").value = ${quantity};`;\n    }\n\n    function targetAttack(name) {\n      return (\n        \"window.frames['\" +\n        name +\n        \"'].document.getElementById('target_attack').click ();\"\n      );\n    }\n\n    function sendAttack(name) {\n      return (\n        \"window.frames['\" +\n        name +\n        \"'].document.getElementById('troop_confirm_go').click ();\"\n      );\n    }\n\n    var url = window.location.href;\n    var iframes = \"\";\n    var setTroops = \"\";\n    var targetAttacks = [];\n    var sendAttacks = \"\";\n    for (i = 1; i <= 5; i++) {\n      iframes += createIframe(\"name\" + i, url);\n      setTroops += setTroop(`name${i}`, IDLE.troop, IDLE.quantity);\n      targetAttacks.push(targetAttack(\"name\" + i));\n      sendAttacks += sendAttack(\"name\" + i);\n    }\n\n    document.body.innerHTML = iframes;\n\n    await delay(6000);\n    eval(setTroops);\n\n    for (let i = 0; i < targetAttacks.length; i++) {\n      await delay(2000, 2000);\n      eval(targetAttacks[i]);\n    }\n\n    await delay(5000);\n    eval(sendAttacks);\n  } catch (error) {\n    reject(error);\n  }\n\n  resolve();\n});\n"}],"lastSchedule":"2021-06-21T04:18:55.939Z"}
